{% import 'macros.html' as macros %}

{% macro experiment_row(exp) -%}
<tr>
  <td class="name">
    <a href="{{ url_for('experiments.read_experiment', exp_id=exp.id) }}">{{exp.name}}</a>
  </td>
  <td class="start">{{exp.start|datetime_format}}</td>
  <td class="stop">{{exp.stop|datetime_format}}</td>
</tr>
{%- endmacro %}

{% macro create_row(form, action, id, name="", start="",
stop="",submit="Create", class_="") -%}
<form action="{{ action }}" id="{{ id }}" class="{{ class_ }}" method="post">
  <td>{{ macros.render_field(form.name, label_visible=false, value=name) }}</td>
  <td>{{ macros.render_field(form.start, label_visible=false, value=start) }}</td>
  <td>{{ macros.render_field(form.stop, label_visible=false, value=stop) }}</td>
  <td>{{ macros.render_field(form.submit, value=submit) }}</td>
  <td></td>
</form>
{%- endmacro %}

{% import "macros.html" as macros %}

{% macro activity_table(form, mapping) %}
<table class="table">
  <thead>
    <tr>
      <th>Type</th>
      <th>Datasets</th>
      <th>Text</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    {% for activity_field in form.activities %}
    {% if mapping[activity_field.data] %}
      {{ activity_row(mapping[activity_field.data], activity_field) }}
    {% endif %}
    {% endfor %}
  </tbody>
</table>
{% endmacro %}

{% macro activity_row(activity, field) %}
  <tr>
    <td>{{ activity.type }}</td>
    <td>
      {% if activity.datasets %}
      {% for dataset in activity.datasets %}
      {{ dataset.id }}
      {% endfor %}
      {% else %}
      -
      {% endif %}
    </td>
    <td>
      {% if "question" in activity.type %}
      {{ activity.question }}
      {% else %}
      -
      {% endif %}
    </td>
    <td>{{ field }}</td>
  </tr>
{% endmacro %}
